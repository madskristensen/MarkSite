@using System.Configuration;
@{
	// Make sure all URLs end with a slash
	if (!Request.QueryString["path"].EndsWith("/"))
	{
		Response.RedirectPermanent(Request.QueryString["path"] + "/", true);
	}

	MarkdownPage page = PageSystem.GetCurrentPage(Request);

	Page.Title = page.Title + " - Visual Studio";
	Page.Description = page.Description;
	Page.Keywords = page.Keywords;
	Page.Theme = ConfigurationManager.AppSettings["theme"];

	if (Request.Headers["x-content-only"] == "1")
	{
		@Helpers.RenderBreadcrumb(PageSystem.GetCurrentPage(Request))
		Response.Headers.Add("x-title", Page.Title);
	}
	else
	{
		Layout = "~/themes/" + Page.Theme + "/_layout.cshtml";
	}

	WebPageHttpHandler.DisableWebPagesResponseHeader = true;
	PageSystem.SetCacheHeaders(Context);
}

@RenderPage("themes/" + Page.Theme + "/page.cshtml", page)