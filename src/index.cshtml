@using System.Configuration;
@using System.Web.Caching;
@{
	// Make sure all URLs end with a slash
	if (!Request.QueryString["path"].EndsWith("/"))
	{
		Response.RedirectPermanent(Request.QueryString["path"] + "/", true);
	}

	MarkdownPage page = PageSystem.GetCurrentPage(Request);

	Page.Title = PageSystem.GetTitle(page);
	Page.Description = page.Description;
	Page.Keywords = page.Keywords;
	Page.Theme = ConfigurationManager.AppSettings["theme"];

	Layout = "~/themes/" + Page.Theme + "/_layout.cshtml";

	WebPageHttpHandler.DisableWebPagesResponseHeader = true;
	PageSystem.SetCacheHeaders(Context);
}

@RenderPage("themes/" + Page.Theme + "/page.cshtml", page)